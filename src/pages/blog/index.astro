---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Navigation from '../../components/Navigation.astro';
import Footer from '../../components/Footer.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<BaseLayout title="Blog">
  <Navigation slot="navigation" />
  
  <div class="row t30 b20">
    <div class="small-12 columns">
      <h1>Blog</h1>
      
      {posts.map((post) => (
        <article class="blog-post" style="margin-bottom: 2rem;">
          <header>
            <h2>
              <a href={`/blog/${post.slug}/`}>{post.data.title}</a>
            </h2>
            <p class="subheadline">
              <time datetime={post.data.date.toISOString()}>
                {post.data.date.toLocaleDateString('en-US', { 
                  year: 'numeric', 
                  month: 'long', 
                  day: 'numeric' 
                })}
              </time>
              {post.data.categories && ` â€¢ ${post.data.categories}`}
            </p>
          </header>
          
          {post.data.teaser && (
            <p class="teaser">{post.data.teaser}</p>
          )}
          
          <a href={`/blog/${post.slug}/`} class="button tiny radius">Read More</a>
        </article>
      ))}
    </div>
  </div>

  <Footer slot="footer" />
</BaseLayout>
